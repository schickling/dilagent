flowchart TD
    Start([ğŸ START<br/>User Problem]) --> ReproContainer
    
    subgraph ReproContainer ["ğŸ”¬ REPRODUCTION STAGE"]
        direction TB
        Repro["dilagent manager repro<br/>â€¢ Create minimal repro.ts<br/>â€¢ Measure timing<br/>â€¢ Document setup"]
        
        Repro --> Success{âœ… Success<br/>âš¡/â³/ğŸ”§}
        Repro --> NeedInfo{â“ NeedMoreInfo<br/>Questions for user}
        
        NeedInfo --> UserQA[ğŸ‘¤ User Q&A<br/>Answer questions]
        UserQA --> Repro
    end
    
    subgraph HypoGenContainer ["ğŸ§  HYPOTHESIS GENERATION"]
        direction TB
        HypothesisGen["dilagent manager generate-hypotheses<br/>â€¢ Uses reproduction data<br/>â€¢ Context-aware hypotheses<br/>â€¢ Based on repro type"]
        
        HypothesesFile[(ğŸ“„ hypotheses.json<br/>H001, H002, H003...)]
        
        HypothesisGen --> HypothesesFile
    end
    
    subgraph HypoTestContainer ["ğŸ§ª HYPOTHESIS TESTING"]
        direction LR
        Testing["dilagent manager run-hypotheses<br/>â€¢ Parallel execution<br/>â€¢ Individual worktrees<br/>â€¢ Independent testing"]
        
        subgraph H001Container ["H001"]
            direction TB
            H001Proven[âœ… Proven<br/>Root cause found]
            H001Disproven[âŒ Disproven<br/>Not the issue]
            H001Inconclusive[â“ Inconclusive<br/>Very rare, last resort]
        end
        
        subgraph H002Container ["H002"]
            H002[" "]
        end
        
        subgraph H003Container ["H003"]
            H003[" "]
        end
        
        Testing --> H001Container
        Testing --> H002Container
        Testing --> H003Container
        
        Results[ğŸ“Š Results Summary]
        H001Proven --> Results
        H001Disproven --> Results
        H001Inconclusive --> Results
        H002 --> Results
        H003 --> Results
    end
    
    subgraph REPLContainer ["ğŸ’¬ INTERACTIVE EXPLORATION"]
        direction TB
        REPL["dilagent manager repl<br/>Interactive debugging"]
    end
    
    Success --> HypothesisGen
    HypothesesFile --> Testing
    
    Results --> OptionalREPL{ğŸ¤” Need Interactive<br/>Exploration?}
    OptionalREPL -->|Yes| REPL
    OptionalREPL -->|No| End([ğŸ END<br/>Issue resolved])
    
    REPL --> End
    
    
    %% Styling
    classDef startEnd fill:#e1f5fe
    classDef process fill:#f3e5f5
    classDef decision fill:#fff3e0
    classDef data fill:#e8f5e8
    classDef success fill:#c8e6c9
    classDef error fill:#ffcdd2
    classDef info fill:#e3f2fd
    
    class Start,End startEnd
    class Repro,HypothesisGen,Testing,REPL,All process
    class Success,Failed,NeedInfo,OptionalREPL decision
    class HypothesesFile data
    class Proven,Diagnosed success
    class Disproven,Failed error
    class UserQA,FallbackHypothesis info